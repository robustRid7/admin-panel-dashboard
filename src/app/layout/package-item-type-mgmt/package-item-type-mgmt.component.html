<div class="main-wrapper">
  <div class="container-fluid">
    <div class="row align-items-center">
      <div class="col-12">
        <div class="heading-row mb-3">
          <h3>Sign Up User</h3>
        </div>
      </div>
    </div>

    <!-- 🔍 Filters -->
    <div class="card shadow-sm mb-4">
      <div class="card-body">
        <form [formGroup]="form" class="row g-3 align-items-end">
          <div class="col-md-3 position-relative dp-down">
            <label class="form-label">Select Domain</label>
            <!-- <input type="text" class="form-control" placeholder="Search domain" [formControl]="domainCtrl"
              (input)="filterDomains()" (click)="toggleDomainDropdown()"> -->
            <input type="text" class="form-control" placeholder="Search domain" [formControl]="domainCtrl"
              (input)="filterDomains()" (click)="toggleDomainDropdown()">


            <!-- Dropdown List -->
            <ul class="list-group position-absolute w-100" *ngIf="showDomainDropdown && filteredDomainList.length > 0"
              style="z-index:1000; max-height:200px; overflow-y:auto;">
              <li class="list-group-item list-group-item-action" [title]="d.domainName"
                *ngFor="let d of filteredDomainList" (click)="selectDomain(d)">
                {{ d.domain }}
              </li>
            </ul>
          </div>

          <!-- Campaign Dropdown with Search -->
          <div class="col-md-3 position-relative dp-down">
            <label class="form-label">Select campaign</label>
            <input type="text" class="form-control" placeholder="Search campaign" [formControl]="campaignCtrl"
              (input)="filterCampaigns()" (click)="toggleDropdown()">

            <!-- Dropdown List -->
            <ul class="list-group position-absolute w-100 group-list"
              *ngIf="showDropdown && filteredCampaignsList.length > 0"
              style="z-index:1000; max-height:200px; overflow-y:auto;">
              <li class="list-group-item list-group-item-action" [title]="c.campaignId"
                *ngFor="let c of filteredCampaignsList" (click)="selectCampaign(c)">
                {{ c.campaignId }} - {{ c.campaignName }}
              </li>
            </ul>
          </div>

          <!-- From Date -->
          <div class="col-md-3">
            <label class="form-label">From Date</label>
            <input type="date" class="form-control" formControlName="from">
          </div>

          <!-- To Date -->
          <div class="col-md-3">
            <label class="form-label">To Date</label>
            <input type="date" class="form-control" formControlName="to">
          </div>

          <div class="col-md-3 d-flex gap-2">
            <button type="button" class="btn btn-primary w-50" (click)="search()">
              <i class="bi bi-search"></i> Search
            </button>
            <button type="button" class="btn btn-danger w-50" (click)="resetFilters()">
              <i class="bi bi-arrow-counterclockwise"></i> Reset
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- 📋 Table -->
    <div class="card shadow-sm">
      <div class="table-responsive">
        <table class="table table-bordered table-striped align-middle">
          <thead class="table-dark">
            <tr>
              <th>S.No.</th>
              <th>Domain</th>
              <th>Campaign - Id</th>
              <th>Campaign Name</th>
              <th>Bonus - Id</th>
              <th>Medium</th>
              <th>UserId</th>
              <th>User Name</th>
              <th>Email</th>
              <th>Mobile</th>
              <th>Created At</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let element of dataSource1; let i = index">
              <td>{{ i + 1 + (pageIndex * pageSize) }}</td>
              <td>{{ element?.domain }}</td>
              <td>{{ element?.campaignId?.campaignId }}</td>
              <td>{{ element?.campaignId?.campaignName }}</td>
              <td>{{ element?.bonusId }}</td>
              <td>{{ element?.medium }}</td>
              <td>{{ element?.userId }}</td>
              <td>{{ element?.userName }}</td>
              <td>{{ element?.email }}</td>
              <td>{{ element?.mobileNumber }}</td>
              <td>{{ element?.createdAt | date:'medium' }}</td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- 📌 Pagination -->
      <div class="card-footer d-flex justify-content-between align-items-center">
        <div>Showing {{ pageIndex * pageSize + 1 }} -
          {{ (pageIndex * pageSize) + dataSource1.length }}
          of {{ totalRecords }}</div>

        <nav>
          <ul class="pagination mb-0">
            <li class="page-item" [class.disabled]="pageIndex === 0">
              <a class="page-link" (click)="prevPage()">Previous</a>
            </li>
            <li class="page-item" [class.disabled]="(pageIndex + 1) * pageSize >= totalRecords">
              <a class="page-link" (click)="nextPage()">Next</a>
            </li>
          </ul>
        </nav>
      </div>
    </div>

  </div>
</div>