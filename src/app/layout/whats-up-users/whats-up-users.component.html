<div class="main-wrapper">
  <div class="row align-items-center">
    <div class="col-12">
      <div class="heading-row">
        <h3>WhatsApp Users</h3>
      </div>
    </div>
  </div>

  <!-- Filters -->
  <div class="shadow-box mt-0 p-3">
    <form [formGroup]="form" class="row g-3 align-items-end">
      <div class="col-md-3 position-relative dp-down">
        <label class="form-label">Select campaign</label>
        <input type="text" class="form-control" placeholder="Search campaign" [formControl]="campaignCtrl"
          (input)="filterCampaigns()" (click)="toggleDropdown()">

        <!-- Dropdown List -->
        <ul class="list-group position-absolute w-100" *ngIf="showDropdown && filteredCampaignsList.length > 0"
          style="z-index:1000; max-height:200px; overflow-y:auto;">
          <li class="list-group-item list-group-item-action" [title]="c.campaignId" *ngFor="let c of filteredCampaignsList"
            (click)="selectCampaign(c)">
            {{ c.campaignId }} - {{ c.campaignName }}
          </li>
        </ul>
      </div>

      <div class="col-md-3">
        <label class="form-label">From Date</label>
        <input type="date" class="form-control" formControlName="from" />
      </div>

      <div class="col-md-3">
        <label class="form-label">To Date</label>
        <input type="date" class="form-control" formControlName="to" />
      </div>

       <div class="col-md-3 d-flex gap-2">
            <button type="button" class="btn btn-primary w-50" (click)="search()">
              <i class="bi bi-search"></i> Search
            </button>
            <button type="button" class="btn btn-danger w-50" (click)="resetFilters()">
              <i class="bi bi-arrow-counterclockwise"></i> Reset
            </button>
          </div>
    </form>
  </div>

  <!-- Table -->
  <div class="shadow-box mt-3 p-3">
    <div class="table-responsive">
      <table class="table table-striped table-bordered align-middle">
        <thead class="table-dark">
          <tr>
            <th>S.No.</th>
            <th>Campaign - Id</th>
            <th>Campaign Name</th>
            <th>Bonus - Id</th>
            <th>Domain</th>
            <th>Medium</th>
            <th>WhatsApp No</th>
            <th>Created At</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let element of dataSource1; let i = index">
            <td>{{ i + 1 + (pageIndex * pageSize) }}</td>
            <td>{{ element?.campaignId?.campaignId }}</td>
            <td>{{ element?.campaignId?.campaignName }}</td>
            <td>{{ element?.bonusId }}</td>
            <td>{{ element?.domain }}</td>
            <td>{{ element?.medium }}</td>
            <td>{{ element?.whatsAppNumber }}</td>
            <td>{{ element?.createdAt | date: 'medium' }}</td>
          </tr>
          <tr *ngIf="dataSource1.length === 0">
            <td colspan="8" class="text-center">No records found</td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- Pagination -->
    <nav class="d-flex justify-content-between align-items-center">
      <div>
        Showing {{ pageIndex * pageSize + 1 }} -
        {{ (pageIndex + 1) * pageSize > totalRecords ? totalRecords : (pageIndex + 1) * pageSize }}
        of {{ totalRecords }}
      </div>
      <ul class="pagination mb-0">
        <li class="page-item" [class.disabled]="pageIndex === 0">
          <a class="page-link" (click)="changePage(pageIndex - 1)">Previous</a>
        </li>
        <li class="page-item" [class.disabled]="(pageIndex + 1) * pageSize >= totalRecords">
          <a class="page-link" (click)="changePage(pageIndex + 1)">Next</a>
        </li>
      </ul>
    </nav>
  </div>
</div>
